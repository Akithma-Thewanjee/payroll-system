<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payroll Management System</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
   
:root {
    --rich-black: #0A0E17;
    --midnight-blue: #121B2E;
    --navy-blue: #1A2746;
    --royal-blue: #2A3F7A;
    --electric-blue: #4A6FE3;
    --platinum: #E8E6E3;
    --slate-gray: #8A93A5;
    --emerald: #10B981;
    --ruby: #EF4444;
    --sapphire: #3B82F6;
    
    /* Shadows */
    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
    --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
    --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
    
    /* Borders */
    --border-radius-sm: 8px;
    --border-radius-md: 12px;
    --border-radius-lg: 16px;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Inter', 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
    letter-spacing: 0.3px;
}

body {
    background-color: var(--rich-black);
    color: var(--platinum);
    background-image: 
        radial-gradient(at 40% 20%, rgba(26, 39, 70, 0.4) 0px, transparent 50%),
        radial-gradient(at 80% 0%, rgba(42, 63, 122, 0.3) 0px, transparent 50%),
        radial-gradient(at 0% 50%, rgba(10, 14, 23, 0.4) 0px, transparent 50%);
    min-height: 100vh;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.hidden {
    display: none !important;
}

/* ===== LOGIN PAGE ===== */
.login-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background: linear-gradient(135deg, var(--rich-black) 0%, var(--midnight-blue) 50%, var(--navy-blue) 100%);
}

.login-box {
    background: rgba(26, 39, 70, 0.85);
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: var(--shadow-lg);
    border-radius: var(--border-radius-lg);
    padding: 40px;
    width: 100%;
    max-width: 400px;
    position: relative;
    overflow: hidden;
}

.login-box::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--electric-blue), var(--gold-accent));
}

.login-title {
    text-align: center;
    margin-bottom: 30px;
    color: var(--platinum);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    position: relative;
    padding-bottom: 15px;
}

.login-title::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 3px;
    background: var(--gold-accent);
}

.form-group {
    margin-bottom: 20px;
}

label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--platinum);
}

input, select {
    width: 100%;
    padding: 12px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: var(--platinum);
    border-radius: var(--border-radius-sm);
    font-size: 16px;
    transition: all 0.3s ease;
}

input:focus, select:focus {
    outline: none;
    border-color: var(--electric-blue);
    box-shadow: 0 0 0 3px rgba(74, 111, 227, 0.2);
    background: rgba(255, 255, 255, 0.08);
}

input::placeholder {
    color: var(--slate-gray);
}

button {
    background: linear-gradient(135deg, var(--royal-blue) 0%, var(--electric-blue) 100%);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    font-size: 16px;
    font-weight: 600;
    width: 100%;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

button::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    transition: left 0.5s ease;
}

button:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-md);
}

button:hover::before {
    left: 100%;
}

button:active {
    transform: translateY(0);
}

.toggle-form {
    text-align: center;
    margin-top: 20px;
}

.toggle-form a {
    color: var(--electric-blue);
    text-decoration: none;
    cursor: pointer;
    font-weight: 600;
}

/* ===== DASHBOARD ===== */
.dashboard {
    display: grid;
    grid-template-columns: 250px 1fr;
    min-height: 100vh;
    background: var(--rich-black);
}

.sidebar {
    background: linear-gradient(180deg, var(--midnight-blue) 0%, var(--navy-blue) 100%);
    color: white;
    padding: 20px;
    border-right: 1px solid rgba(255, 255, 255, 0.05);
    box-shadow: 3px 0 20px rgba(0, 0, 0, 0.3);
    position: relative;
}

.sidebar::after {
    content: '';
    position: absolute;
    right: 0;
    top: 0;
    bottom: 0;
    width: 1px;
    background: linear-gradient(to bottom, transparent, rgba(212, 175, 55, 0.3), transparent);
}

.sidebar h2 {
    margin-bottom: 30px;
    text-align: center;
    color: var(--gold-accent);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    position: relative;
    padding-bottom: 20px;
}

.sidebar h2::after {
    content: '';
    position: absolute;
    bottom: 10px;
    left: 25%;
    width: 50%;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--gold-accent), transparent);
}

.sidebar ul {
    list-style: none;
}

.sidebar li {
    margin-bottom: 15px;
}

.sidebar a {
    color: var(--slate-gray);
    text-decoration: none;
    display: block;
    padding: 10px;
    border-radius: var(--border-radius-sm);
    transition: all 0.3s ease;
    position: relative;
    border-left: 3px solid transparent;
}

.sidebar a:hover {
    color: var(--platinum);
    background: rgba(255, 255, 255, 0.05);
    border-left-color: var(--electric-blue);
    padding-left: 15px;
}

.sidebar a.active {
    color: var(--platinum);
    background: linear-gradient(90deg, rgba(74, 111, 227, 0.1), transparent);
    border-left-color: var(--electric-blue);
    font-weight: 600;
}

.sidebar a.active::before {
    content: '';
    position: absolute;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    width: 8px;
    height: 8px;
    background: var(--electric-blue);
    border-radius: 50%;
    box-shadow: 0 0 10px var(--electric-blue);
}

.main-content {
    padding: 20px;
    background: transparent;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding: 20px;
    padding-bottom: 15px;
    background: rgba(26, 39, 70, 0.5);
    backdrop-filter: blur(10px);
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    margin: -20px -20px 30px -20px;
    border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
}

.header h1 {
    color: var(--platinum);
    font-weight: 700;
    background: linear-gradient(90deg, var(--electric-blue), var(--gold-accent));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    font-size: 1.8rem;
}

.user-info {
    display: flex;
    align-items: center;
}

.user-info span {
    margin-right: 15px;
    color: var(--slate-gray);
    font-weight: 500;
}

.logout-btn {
    background: linear-gradient(135deg, #374151 0%, #6B7280 100%);
    width: auto;
    padding: 8px 15px;
}

.logout-btn:hover {
    background: linear-gradient(135deg, #4B5563 0%, #9CA3AF 100%);
}

/* ===== CARD STYLES ===== */
.card {
    background: linear-gradient(145deg, rgba(26, 39, 70, 0.7), rgba(18, 27, 46, 0.7));
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: var(--border-radius-md);
    box-shadow: var(--shadow-md);
    padding: 20px;
    margin-bottom: 20px;
    position: relative;
    overflow: hidden;
}

.card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--electric-blue), var(--gold-accent));
}

.card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.card-title {
    font-size: 1.5rem;
    color: var(--platinum);
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
}

.card-title::before {
    content: '';
    display: inline-block;
    width: 4px;
    height: 20px;
    background: var(--electric-blue);
    border-radius: 2px;
}

/* ===== TABLE STYLES ===== */
table {
    width: 100%;
    background: rgba(255, 255, 255, 0.02);
    border-radius: var(--border-radius-sm);
    border-collapse: separate;
    border-spacing: 0;
    border: 1px solid rgba(255, 255, 255, 0.05);
    overflow: hidden;
}

th, td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

th {
    background: linear-gradient(180deg, rgba(42, 63, 122, 0.3), rgba(26, 39, 70, 0.3));
    color: var(--gold-accent);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

td {
    color: var(--slate-gray);
}

tr:hover td {
    background: rgba(255, 255, 255, 0.03);
    color: var(--platinum);
}

tr:last-child td {
    border-bottom: none;
}

/* ===== BUTTON STYLES ===== */
.btn {
    padding: 6px 12px;
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    border: none;
    font-size: 14px;
    margin-right: 5px;
    transition: all 0.3s ease;
}

.btn-primary {
    background: linear-gradient(135deg, var(--royal-blue) 0%, var(--electric-blue) 100%);
    color: white;
}

.btn-success {
    background: linear-gradient(135deg, var(--emerald) 0%, #34D399 100%);
    color: white;
}

.btn-danger {
    background: linear-gradient(135deg, var(--ruby) 0%, #F87171 100%);
    color: white;
}

.btn-warning {
    background: linear-gradient(135deg, var(--gold-accent) 0%, #FBBF24 100%);
    color: white;
}

/* ===== MODAL STYLES ===== */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(10, 14, 23, 0.95);
    backdrop-filter: blur(5px);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

.modal-content {
    background: linear-gradient(145deg, rgba(26, 39, 70, 0.95), rgba(18, 27, 46, 0.95));
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: var(--shadow-lg);
    border-radius: var(--border-radius-lg);
    padding: 30px;
    width: 90%;
    max-width: 600px;
    max-height: 90vh;
    overflow-y: auto;
}

.modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    padding-bottom: 15px;
}

.close-btn {
    background: none;
    border: none;
    font-size: 24px;
    cursor: pointer;
    color: var(--slate-gray);
    transition: color 0.3s ease;
}

.close-btn:hover {
    color: var(--ruby);
}

/* ===== FORM STYLES ===== */
.form-row {
    display: flex;
    flex-wrap: wrap;
    margin: 0 -10px;
}

.form-col {
    flex: 1;
    padding: 0 10px;
    min-width: 200px;
}

/* ===== STATS CARDS ===== */
.stats-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: linear-gradient(145deg, rgba(26, 39, 70, 0.8), rgba(18, 27, 46, 0.8));
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: var(--border-radius-md);
    box-shadow: var(--shadow-sm);
    padding: 20px;
    text-align: center;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.stat-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-md);
    border-color: rgba(74, 111, 227, 0.3);
}

.stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg, var(--electric-blue), transparent);
}

.stat-value {
    font-size: 2.2rem;
    font-weight: bold;
    margin: 10px 0;
    background: linear-gradient(90deg, var(--electric-blue), var(--gold-accent));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
}

.stat-label {
    color: var(--slate-gray);
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 1px;
}

/* ===== TABS ===== */
.tabs {
    display: flex;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    margin-bottom: 20px;
}

.tab {
    padding: 10px 20px;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    color: var(--slate-gray);
    transition: all 0.3s ease;
    position: relative;
}

.tab:hover {
    color: var(--platinum);
}

.tab.active {
    color: var(--electric-blue);
    border-bottom-color: var(--electric-blue);
    font-weight: 600;
}

.tab.active::after {
    content: '';
    position: absolute;
    bottom: -3px;
    left: 0;
    right: 0;
    height: 3px;
    background: var(--electric-blue);
    box-shadow: 0 0 10px var(--electric-blue);
}

/* ===== TIME TRACKING ===== */
.time-tracker {
    text-align: center;
    padding: 30px;
    background: linear-gradient(145deg, rgba(26, 39, 70, 0.8), rgba(18, 27, 46, 0.8));
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: var(--border-radius-md);
    margin-bottom: 30px;
    position: relative;
    overflow: hidden;
}

.time-tracker::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 30% 20%, rgba(74, 111, 227, 0.1) 0%, transparent 50%);
}

.time-display {
    font-size: 3.5rem;
    font-weight: bold;
    margin: 20px 0;
    text-shadow: 0 0 20px rgba(74, 111, 227, 0.5);
    background: linear-gradient(90deg, var(--electric-blue), var(--platinum));
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
}

.clock-btn {
    font-size: 1.2rem;
    padding: 15px 30px;
    margin: 0 10px;
    width: auto;
    min-width: 140px;
}

/* ===== EFFICIENCY TRACKER ===== */
.efficiency-container {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
}

.efficiency-chart-container {
    flex: 1;
    min-width: 300px;
}

.efficiency-table-container {
    flex: 1;
    min-width: 300px;
}

/* ===== CHART CONTAINER ===== */
.chart-container {
    position: relative;
    height: 300px;
    width: 100%;
}

/* ===== STATUS INDICATORS ===== */
.status-indicator {
    display: inline-block;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    margin-right: 5px;
    box-shadow: 0 0 10px currentColor;
}

.status-active {
    background-color: var(--emerald);
    color: var(--emerald);
}

.status-inactive {
    background-color: var(--ruby);
    color: var(--ruby);
}

/* ===== FINANCIAL SUMMARY ===== */
.financial-summary {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.financial-card {
    background: linear-gradient(145deg, rgba(26, 39, 70, 0.7), rgba(18, 27, 46, 0.7));
    border: 1px solid rgba(255, 255, 255, 0.05);
    border-radius: var(--border-radius-md);
    box-shadow: var(--shadow-sm);
    padding: 20px;
    transition: all 0.3s ease;
}

.financial-card:hover {
    transform: translateY(-3px);
    border-color: rgba(74, 111, 227, 0.2);
    box-shadow: var(--shadow-md);
}

.financial-value {
    font-size: 1.6rem;
    font-weight: bold;
    margin: 10px 0;
    color: var(--platinum);
}

.financial-label {
    color: var(--slate-gray);
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 1px;
}

/* ===== RESPONSIVE DESIGN ===== */
@media (max-width: 768px) {
    .dashboard {
        grid-template-columns: 1fr;
    }
    
    .sidebar {
        display: none;
        box-shadow: 0 3px 20px rgba(0, 0, 0, 0.3);
    }
    
    .form-row {
        flex-direction: column;
    }
    
    .form-col {
        width: 100%;
    }
    
    .efficiency-container {
        flex-direction: column;
    }
    
    .time-display {
        font-size: 2.5rem;
    }
    
    .stat-value {
        font-size: 1.8rem;
    }
    
    .financial-value {
        font-size: 1.4rem;
    }
    
    .clock-btn {
        min-width: 120px;
        padding: 12px 20px;
        margin: 5px;
    }
}

/* ===== SCROLLBAR STYLING ===== */
::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, var(--electric-blue), var(--royal-blue));
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(180deg, var(--gold-accent), #C49C30);
}

/* ===== ANIMATIONS ===== */
@keyframes pulse-glow {
    0%, 100% {
        box-shadow: 0 0 5px rgba(74, 111, 227, 0.5);
    }
    50% {
        box-shadow: 0 0 20px rgba(74, 111, 227, 0.8);
    }
}

.pulse {
    animation: pulse-glow 2s infinite;
}

    </style>
</head>
<body>
    <!-- Login/Signup Page -->
    <div id="login-page" class="login-container">
        <div class="login-box">
            <h1 class="login-title">Payroll Management System</h1>
            <div id="login-form">
                <h2>Login</h2>
                <div class="form-group">
                    <label for="login-email">Email Address</label>
                    <input type="email" id="login-email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" placeholder="Enter your password">
                </div>
                <div class="form-group">
                    <label for="login-role">Login As</label>
                    <select id="login-role">
                        <option value="employee">Employee</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <button id="login-btn">Login</button>
                <div class="toggle-form">
                    <p>Don't have an account? <a id="show-signup">Sign Up</a></p>
                </div>
            </div>
            
            <div id="signup-form" class="hidden">
                <h2>Sign Up</h2>
                <div class="form-group">
                    <label for="signup-name">Full Name</label>
                    <input type="text" id="signup-name" placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label for="signup-email">Email Address</label>
                    <input type="email" id="signup-email" placeholder="Enter your email">
                </div>
                <div class="form-group">
                    <label for="signup-password">Password</label>
                    <input type="password" id="signup-password" placeholder="Create a password">
                </div>
                <div class="form-group">
                    <label for="signup-role">Register As</label>
                    <select id="signup-role">
                        <option value="employee">Employee</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <button id="signup-btn">Sign Up</button>
                <div class="toggle-form">
                    <p>Already have an account? <a id="show-login">Login</a></p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Admin Dashboard -->
    <div id="admin-dashboard" class="dashboard hidden">
        <div class="sidebar">
            <h2>Admin Panel</h2>
            <ul>
                <li><a href="#" class="nav-link active" data-page="dashboard">Dashboard</a></li>
                <li><a href="#" class="nav-link" data-page="employees">Employee Management</a></li>
                <li><a href="#" class="nav-link" data-page="payroll">Payroll Settings</a></li>
                <li><a href="#" class="nav-link" data-page="reports">Reports</a></li>
                <li><a href="#" class="nav-link" data-page="efficiency">Efficiency Tracker</a></li>
                <li><a href="#" class="nav-link" data-page="financial">Financial Summary</a></li>
            </ul>
        </div>
        <div class="main-content">
            <div class="header">
                <h1>Admin Dashboard</h1>
                <div class="user-info">
                    <span id="admin-name">Admin User</span>
                    <button class="logout-btn" id="admin-logout">Logout</button>
                </div>
            </div>
            
            <!-- Dashboard Content -->
            <div id="admin-dashboard-content" class="page-content">
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-label">Total Employees</div>
                        <div class="stat-value" id="total-employees">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Active Today</div>
                        <div class="stat-value" id="active-today">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Currently Working</div>
                        <div class="stat-value" id="currently-working">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">This Month's Payroll</div>
                        <div class="stat-value" id="month-payroll">$0</div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Currently Working Employees</h2>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th>Department</th>
                                <th>Position</th>
                                <th>Clock In Time</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="working-employees">
                            <!-- Working employees will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Recent Activity</h2>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th>Action</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="recent-activity">
                            <!-- Activity rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Employee Management -->
            <div id="admin-employees-content" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Employee Management</h2>
                        <button class="btn btn-primary" id="add-employee-btn">Add Employee</button>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Level</th>
                                <th>Department</th>
                                <th>Position</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="employees-table">
                            <!-- Employee rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Payroll Settings -->
            <div id="admin-payroll-content" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Payroll Settings</h2>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="hourly-rate">Basic Hourly Rate ($)</label>
                                <input type="number" id="hourly-rate" step="0.01" min="0">
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="ot-rate">Overtime Rate (Multiplier)</label>
                                <input type="number" id="ot-rate" step="0.1" min="1" value="1.5">
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="allowance-rate">Allowance Rate ($/month)</label>
                                <input type="number" id="allowance-rate" step="0.01" min="0">
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="epf-rate">EPF Rate (%)</label>
                                <input type="number" id="epf-rate" step="0.01" min="0" max="100" value="8">
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="etf-rate">ETF Rate (%)</label>
                                <input type="number" id="etf-rate" step="0.01" min="0" max="100" value="3">
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="tax-rate">Tax Rate (%)</label>
                                <input type="number" id="tax-rate" step="0.01" min="0" max="100" value="10">
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary" id="save-payroll-settings">Save Settings</button>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Loan Management</h2>
                        <button class="btn btn-primary" id="add-loan-btn">Add Loan</button>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Employee</th>
                                <th>Loan Amount</th>
                                <th>Installments</th>
                                <th>Monthly Payment</th>
                                <th>Remaining</th>
                                <th>Start Date</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="loans-table">
                            <!-- Loan rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Reports -->
            <div id="admin-reports-content" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Payroll Reports</h2>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="report-month">Select Month</label>
                                <input type="month" id="report-month">
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="report-employee">Select Employee (Optional)</label>
                                <select id="report-employee">
                                    <option value="all">All Employees</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary" id="generate-report">Generate Report</button>
                    <button class="btn btn-success" id="export-pdf">Export as PDF</button>
                    
                    <div id="report-results" class="hidden">
                        <h3>Payroll Report for <span id="report-period"></span></h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>Department</th>
                                    <th>Basic Salary</th>
                                    <th>Overtime</th>
                                    <th>Allowances</th>
                                    <th>Deductions</th>
                                    <th>Net Pay</th>
                                </tr>
                            </thead>
                            <tbody id="report-table">
                                <!-- Report rows will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Efficiency Tracker -->
            <div id="admin-efficiency-content" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Employee Efficiency</h2>
                    </div>
                    <div class="tabs">
                        <div class="tab active" data-level="all">All Levels</div>
                        <div class="tab" data-level="1">Level 1</div>
                        <div class="tab" data-level="2">Level 2</div>
                        <div class="tab" data-level="3">Level 3</div>
                    </div>
                    
                    <div class="efficiency-container">
                        <div class="efficiency-chart-container">
                            <div class="chart-container">
                                <canvas id="efficiency-pie-chart"></canvas>
                            </div>
                        </div>
                        <div class="efficiency-table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Rank</th>
                                        <th>Employee</th>
                                        <th>Level</th>
                                        <th>Department</th>
                                        <th>Hours Worked</th>
                                        <th>Efficiency Score</th>
                                    </tr>
                                </thead>
                                <tbody id="efficiency-table">
                                    <!-- Efficiency rows will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Financial Summary -->
            <div id="admin-financial-content" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Financial Summary</h2>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="financial-month">Select Month</label>
                                <input type="month" id="financial-month">
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary" id="generate-financial">Generate Summary</button>
                    
                    <div id="financial-results" class="hidden">
                        <h3>Financial Summary for <span id="financial-period"></span></h3>
                        
                        <div class="financial-summary">
                            <div class="financial-card">
                                <div class="financial-label">Total Salary Paid</div>
                                <div class="financial-value" id="total-salary">$0</div>
                            </div>
                            <div class="financial-card">
                                <div class="financial-label">Total EPF Contribution</div>
                                <div class="financial-value" id="total-epf">$0</div>
                            </div>
                            <div class="financial-card">
                                <div class="financial-label">Total ETF Contribution</div>
                                <div class="financial-value" id="total-etf">$0</div>
                            </div>
                            <div class="financial-card">
                                <div class="financial-label">Total Tax Deducted</div>
                                <div class="financial-value" id="total-tax">$0</div>
                            </div>
                            <div class="financial-card">
                                <div class="financial-label">Total Loan Recoveries</div>
                                <div class="financial-value" id="total-loans">$0</div>
                            </div>
                            <div class="financial-card">
                                <div class="financial-label">Net Payroll Cost</div>
                                <div class="financial-value" id="net-payroll">$0</div>
                            </div>
                        </div>
                        
                        <h4>Department-wise Breakdown</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Department</th>
                                    <th>Employees</th>
                                    <th>Total Salary</th>
                                    <th>Total EPF</th>
                                    <th>Total ETF</th>
                                </tr>
                            </thead>
                            <tbody id="department-breakdown">
                                <!-- Department breakdown will be populated by JavaScript -->
                            </tbody>
                        </table>
                        
                        <h4>Active Loans</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>Loan Amount</th>
                                    <th>Monthly Payment</th>
                                    <th>Remaining Balance</th>
                                    <th>Start Date</th>
                                </tr>
                            </thead>
                            <tbody id="active-loans">
                                <!-- Active loans will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Employee Dashboard -->
    <div id="employee-dashboard" class="dashboard hidden">
        <div class="sidebar">
            <h2>Employee Panel</h2>
            <ul>
                <li><a href="#" class="nav-link active" data-page="dashboard">Dashboard</a></li>
                <li><a href="#" class="nav-link" data-page="profile">My Profile</a></li>
                <li><a href="#" class="nav-link" data-page="timesheet">Timesheet</a></li>
                <li><a href="#" class="nav-link" data-page="payroll">My Payroll</a></li>
            </ul>
        </div>
        <div class="main-content">
            <div class="header">
                <h1>Employee Dashboard</h1>
                <div class="user-info">
                    <span id="employee-name">Employee User</span>
                    <button class="logout-btn" id="employee-logout">Logout</button>
                </div>
            </div>
            
            <!-- Employee Dashboard Content -->
            <div id="employee-dashboard-content" class="page-content">
                <div class="time-tracker">
                    <h2>Time Tracker</h2>
                    <div class="time-display" id="current-time">00:00:00</div>
                    <div>
                        <button class="btn btn-success clock-btn" id="clock-in-btn">Clock In</button>
                        <button class="btn btn-danger clock-btn" id="clock-out-btn" disabled>Clock Out</button>
                    </div>
                    <p id="clock-status">You are currently clocked out</p>
                </div>
                
                <div class="stats-container">
                    <div class="stat-card">
                        <div class="stat-label">Hours This Week</div>
                        <div class="stat-value" id="hours-week">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Hours This Month</div>
                        <div class="stat-value" id="hours-month">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Overtime Hours</div>
                        <div class="stat-value" id="overtime-hours">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Next Payday</div>
                        <div class="stat-value" id="next-payday">15th</div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Recent Activity</h2>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Clock In</th>
                                <th>Clock Out</th>
                                <th>Hours</th>
                            </tr>
                        </thead>
                        <tbody id="employee-activity">
                            <!-- Activity rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Employee Profile -->
            <div id="employee-profile-content" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">My Profile</h2>
                        <button class="btn btn-primary" id="edit-profile-btn">Edit Profile</button>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="emp-name">Full Name</label>
                                <input type="text" id="emp-name" readonly>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="emp-email">Email Address</label>
                                <input type="email" id="emp-email" readonly>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="emp-id">Employee ID</label>
                                <input type="text" id="emp-id" readonly>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="emp-level">Level</label>
                                <input type="text" id="emp-level" readonly>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="emp-department">Department</label>
                                <input type="text" id="emp-department" readonly>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="emp-position">Position</label>
                                <input type="text" id="emp-position" readonly>
                            </div>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="emp-join-date">Join Date</label>
                                <input type="text" id="emp-join-date" readonly>
                            </div>
                        </div>
                        <div class="form-col">
                            <div class="form-group">
                                <label for="emp-salary">Basic Salary</label>
                                <input type="text" id="emp-salary" readonly>
                            </div>
                        </div>
                    </div>
                    <div id="profile-edit-buttons" class="hidden">
                        <button class="btn btn-success" id="save-profile-btn">Save Changes</button>
                        <button class="btn btn-danger" id="cancel-profile-btn">Cancel</button>
                    </div>
                </div>
            </div>
            
            <!-- Employee Timesheet -->
            <div id="employee-timesheet-content" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">My Timesheet</h2>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="timesheet-month">Select Month</label>
                                <input type="month" id="timesheet-month">
                            </div>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Clock In</th>
                                <th>Clock Out</th>
                                <th>Regular Hours</th>
                                <th>Overtime Hours</th>
                                <th>Total Hours</th>
                            </tr>
                        </thead>
                        <tbody id="timesheet-table">
                            <!-- Timesheet rows will be populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Employee Payroll -->
            <div id="employee-payroll-content" class="page-content hidden">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">My Payroll</h2>
                        <button class="btn btn-success" id="export-payroll-pdf">Export as PDF</button>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <div class="form-group">
                                <label for="payroll-month">Select Month</label>
                                <input type="month" id="payroll-month">
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary" id="view-payroll-btn">View Payroll</button>
                    
                    <div id="payroll-details" class="hidden">
                        <h3>Payroll for <span id="payroll-period"></span></h3>
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label>Basic Salary</label>
                                    <input type="text" id="payroll-basic" readonly>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label>Overtime Pay</label>
                                    <input type="text" id="payroll-overtime" readonly>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label>Allowances</label>
                                    <input type="text" id="payroll-allowances" readonly>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label>Gross Pay</label>
                                    <input type="text" id="payroll-gross" readonly>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label>EPF Deduction</label>
                                    <input type="text" id="payroll-epf" readonly>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label>ETF Deduction</label>
                                    <input type="text" id="payroll-etf" readonly>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label>Tax Deduction</label>
                                    <input type="text" id="payroll-tax" readonly>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label>Loan Installment</label>
                                    <input type="text" id="payroll-loan" readonly>
                                </div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-col">
                                <div class="form-group">
                                    <label>Total Deductions</label>
                                    <input type="text" id="payroll-deductions" readonly>
                                </div>
                            </div>
                            <div class="form-col">
                                <div class="form-group">
                                    <label>Net Pay</label>
                                    <input type="text" id="payroll-net" readonly>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Employee Modal -->
    <div id="add-employee-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Employee</h2>
                <button class="close-btn" id="close-employee-modal">&times;</button>
            </div>
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="new-emp-name">Full Name</label>
                        <input type="text" id="new-emp-name">
                    </div>
                </div>
                <div class="form-col">
                    <div class="form-group">
                        <label for="new-emp-email">Email Address</label>
                        <input type="email" id="new-emp-email">
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="new-emp-password">Password</label>
                        <input type="password" id="new-emp-password">
                    </div>
                </div>
                <div class="form-col">
                    <div class="form-group">
                        <label for="new-emp-level">Level</label>
                        <select id="new-emp-level">
                            <option value="1">Level 1</option>
                            <option value="2">Level 2</option>
                            <option value="3">Level 3</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="new-emp-department">Department</label>
                        <select id="new-emp-department">
                            <option value="IT">IT</option>
                            <option value="HR">HR</option>
                            <option value="Finance">Finance</option>
                            <option value="Marketing">Marketing</option>
                            <option value="Operations">Operations</option>
                            <option value="Sales">Sales</option>
                            <option value="Customer Service">Customer Service</option>
                            <option value="Production">Production</option>
                            <option value="Quality Control">Quality Control</option>
                            <option value="Research & Development">Research & Development</option>
                        </select>
                    </div>
                </div>
                <div class="form-col">
                    <div class="form-group">
                        <label for="new-emp-position">Position</label>
                        <input type="text" id="new-emp-position">
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="new-emp-salary">Basic Salary ($)</label>
                        <input type="number" id="new-emp-salary" step="0.01" min="0">
                    </div>
                </div>
                <div class="form-col">
                    <div class="form-group">
                        <label for="new-emp-join-date">Join Date</label>
                        <input type="date" id="new-emp-join-date">
                    </div>
                </div>
            </div>
            <button class="btn btn-primary" id="save-employee-btn">Save Employee</button>
        </div>
    </div>
    
    <!-- Add Loan Modal -->
    <div id="add-loan-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add Loan</h2>
                <button class="close-btn" id="close-loan-modal">&times;</button>
            </div>
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="loan-employee">Employee</label>
                        <select id="loan-employee">
                            <!-- Employee options will be populated by JavaScript -->
                        </select>
                    </div>
                </div>
                <div class="form-col">
                    <div class="form-group">
                        <label for="loan-amount">Loan Amount ($)</label>
                        <input type="number" id="loan-amount" step="0.01" min="0">
                    </div>
                </div>
            </div>
            <div class="form-row">
                <div class="form-col">
                    <div class="form-group">
                        <label for="loan-installments">Number of Installments</label>
                        <input type="number" id="loan-installments" min="1" value="12">
                    </div>
                </div>
                <div class="form-col">
                    <div class="form-group">
                        <label for="loan-date">Start Date</label>
                        <input type="date" id="loan-date">
                    </div>
                </div>
            </div>
            <button class="btn btn-primary" id="save-loan-btn">Save Loan</button>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let employees = [];
        let payrollSettings = {
            hourlyRate: 15.00,
            otRate: 1.5,
            allowanceRate: 200.00,
            epfRate: 8,
            etfRate: 3,
            taxRate: 10
        };
        let loans = [];
        let attendance = [];
        let clockedIn = false;
        let clockInTime = null;
        let efficiencyPieChart = null;
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
        });
        
        function initializeApp() {
            // Check if there's a logged-in user in localStorage
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                if (currentUser.role === 'admin') {
                    showAdminDashboard();
                } else {
                    showEmployeeDashboard();
                }
            }
            
            // Load sample data if not exists
            if (!localStorage.getItem('employees')) {
                loadSampleData();
            } else {
                employees = JSON.parse(localStorage.getItem('employees'));
                payrollSettings = JSON.parse(localStorage.getItem('payrollSettings')) || payrollSettings;
                loans = JSON.parse(localStorage.getItem('loans')) || [];
                attendance = JSON.parse(localStorage.getItem('attendance')) || [];
            }
            
            // Check if user is clocked in
            const clockStatus = localStorage.getItem(`clockStatus_${currentUser?.id}`);
            if (clockStatus && currentUser) {
                clockedIn = JSON.parse(clockStatus);
                if (clockedIn) {
                    clockInTime = new Date(localStorage.getItem(`clockInTime_${currentUser.id}`));
                    updateClockStatus();
                }
            }
        }
        
        function loadSampleData() {
            // Create sample admin
            employees = [
                {
                    id: 1,
                    name: 'Admin User',
                    email: 'admin@company.com',
                    password: 'admin123',
                    role: 'admin',
                    level: 1,
                    department: 'IT',
                    position: 'System Administrator',
                    salary: 5000,
                    joinDate: '2023-01-01',
                    status: 'active'
                },
                {
                    id: 2,
                    name: 'John Doe',
                    email: 'john.doe@company.com',
                    password: 'password123',
                    role: 'employee',
                    level: 3,
                    department: 'Production',
                    position: 'Line Worker',
                    salary: 15,
                    joinDate: '2023-03-15',
                    status: 'active'
                },
                {
                    id: 3,
                    name: 'Jane Smith',
                    email: 'jane.smith@company.com',
                    password: 'password123',
                    role: 'employee',
                    level: 2,
                    department: 'Quality Control',
                    position: 'Quality Inspector',
                    salary: 2500,
                    joinDate: '2023-02-10',
                    status: 'active'
                },
                {
                    id: 4,
                    name: 'Robert Johnson',
                    email: 'robert.johnson@company.com',
                    password: 'password123',
                    role: 'employee',
                    level: 1,
                    department: 'Management',
                    position: 'Department Manager',
                    salary: 6000,
                    joinDate: '2023-01-20',
                    status: 'active'
                },
                {
                    id: 5,
                    name: 'Sarah Williams',
                    email: 'sarah.williams@company.com',
                    password: 'password123',
                    role: 'employee',
                    level: 3,
                    department: 'Production',
                    position: 'Line Worker',
                    salary: 15,
                    joinDate: '2023-04-05',
                    status: 'active'
                },
                {
                    id: 6,
                    name: 'Michael Brown',
                    email: 'michael.brown@company.com',
                    password: 'password123',
                    role: 'employee',
                    level: 2,
                    department: 'IT',
                    position: 'Software Developer',
                    salary: 4000,
                    joinDate: '2023-05-12',
                    status: 'active'
                },
                {
                    id: 7,
                    name: 'Emily Davis',
                    email: 'emily.davis@company.com',
                    password: 'password123',
                    role: 'employee',
                    level: 1,
                    department: 'HR',
                    position: 'HR Manager',
                    salary: 5500,
                    joinDate: '2023-03-22',
                    status: 'active'
                }
            ];
            
            // Sample loans
            loans = [
                {
                    id: 1,
                    employeeId: 2,
                    amount: 1200,
                    installments: 12,
                    monthlyPayment: 100,
                    remaining: 900,
                    startDate: '2023-04-01'
                },
                {
                    id: 2,
                    employeeId: 4,
                    amount: 5000,
                    installments: 24,
                    monthlyPayment: 208.33,
                    remaining: 3750,
                    startDate: '2023-02-15'
                }
            ];
            
            // Sample attendance
            attendance = [
                {
                    id: 1,
                    employeeId: 2,
                    date: '2023-06-01',
                    clockIn: '09:00',
                    clockOut: '17:00',
                    hours: 8,
                    overtime: 0
                },
                {
                    id: 2,
                    employeeId: 2,
                    date: '2023-06-02',
                    clockIn: '08:45',
                    clockOut: '17:30',
                    hours: 8,
                    overtime: 0.75
                },
                {
                    id: 3,
                    employeeId: 3,
                    date: '2023-06-01',
                    clockIn: '09:00',
                    clockOut: '17:00',
                    hours: 8,
                    overtime: 0
                },
                {
                    id: 4,
                    employeeId: 4,
                    date: '2023-06-01',
                    clockIn: '08:30',
                    clockOut: '17:00',
                    hours: 8,
                    overtime: 0.5
                },
                {
                    id: 5,
                    employeeId: 5,
                    date: '2023-06-01',
                    clockIn: '09:15',
                    clockOut: '17:15',
                    hours: 7.5,
                    overtime: 0.5
                },
                {
                    id: 6,
                    employeeId: 6,
                    date: '2023-06-01',
                    clockIn: '08:45',
                    clockOut: '17:45',
                    hours: 8,
                    overtime: 1
                },
                {
                    id: 7,
                    employeeId: 7,
                    date: '2023-06-01',
                    clockIn: '09:00',
                    clockOut: '17:00',
                    hours: 8,
                    overtime: 0
                }
            ];
            
            // Save to localStorage
            localStorage.setItem('employees', JSON.stringify(employees));
            localStorage.setItem('payrollSettings', JSON.stringify(payrollSettings));
            localStorage.setItem('loans', JSON.stringify(loans));
            localStorage.setItem('attendance', JSON.stringify(attendance));
        }
        
        function setupEventListeners() {
            // Login/Signup events
            document.getElementById('show-signup').addEventListener('click', showSignupForm);
            document.getElementById('show-login').addEventListener('click', showLoginForm);
            document.getElementById('login-btn').addEventListener('click', login);
            document.getElementById('signup-btn').addEventListener('click', signup);
            
            // Admin events
            document.getElementById('admin-logout').addEventListener('click', logout);
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const page = this.getAttribute('data-page');
                    if (currentUser.role === 'admin') {
                        showAdminPage(page);
                    } else {
                        showEmployeePage(page);
                    }
                });
            });
            
            // Employee events
            document.getElementById('employee-logout').addEventListener('click', logout);
            
            // Employee management
            document.getElementById('add-employee-btn').addEventListener('click', showAddEmployeeModal);
            document.getElementById('close-employee-modal').addEventListener('click', hideAddEmployeeModal);
            document.getElementById('save-employee-btn').addEventListener('click', saveEmployee);
            
            // Payroll settings
            document.getElementById('save-payroll-settings').addEventListener('click', savePayrollSettings);
            
            // Loan management
            document.getElementById('add-loan-btn').addEventListener('click', showAddLoanModal);
            document.getElementById('close-loan-modal').addEventListener('click', hideAddLoanModal);
            document.getElementById('save-loan-btn').addEventListener('click', saveLoan);
            
            // Reports
            document.getElementById('generate-report').addEventListener('click', generateReport);
            document.getElementById('export-pdf').addEventListener('click', exportReportPDF);
            
            // Financial Summary
            document.getElementById('generate-financial').addEventListener('click', generateFinancialSummary);
            
            // Employee time tracking
            document.getElementById('clock-in-btn').addEventListener('click', clockIn);
            document.getElementById('clock-out-btn').addEventListener('click', clockOut);
            
            // Employee profile
            document.getElementById('edit-profile-btn').addEventListener('click', enableProfileEdit);
            document.getElementById('save-profile-btn').addEventListener('click', saveProfile);
            document.getElementById('cancel-profile-btn').addEventListener('click', cancelProfileEdit);
            
            // Employee timesheet
            document.getElementById('timesheet-month').addEventListener('change', loadEmployeeTimesheet);
            
            // Employee payroll
            document.getElementById('view-payroll-btn').addEventListener('click', viewEmployeePayroll);
            document.getElementById('export-payroll-pdf').addEventListener('click', exportEmployeePayrollPDF);
            
            // Efficiency tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    loadEfficiencyData(this.getAttribute('data-level'));
                });
            });
        }
        
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString();
            document.getElementById('current-time').textContent = timeString;
        }
        
        // Authentication functions
        function showSignupForm() {
            document.getElementById('login-form').classList.add('hidden');
            document.getElementById('signup-form').classList.remove('hidden');
        }
        
        function showLoginForm() {
            document.getElementById('signup-form').classList.add('hidden');
            document.getElementById('login-form').classList.remove('hidden');
        }
        
        function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const role = document.getElementById('login-role').value;
            
            const user = employees.find(emp => 
                emp.email === email && 
                emp.password === password && 
                emp.role === role
            );
            
            if (user) {
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                if (role === 'admin') {
                    showAdminDashboard();
                } else {
                    showEmployeeDashboard();
                }
            } else {
                alert('Invalid email, password, or role selected.');
            }
        }
        
        function signup() {
            const name = document.getElementById('signup-name').value;
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;
            const role = document.getElementById('signup-role').value;
            
            // Check if email already exists
            const existingUser = employees.find(emp => emp.email === email);
            if (existingUser) {
                alert('This email is already registered. Please use a different email.');
                return;
            }
            
            // Create new user
            const newUser = {
                id: employees.length > 0 ? Math.max(...employees.map(emp => emp.id)) + 1 : 1,
                name,
                email,
                password,
                role,
                level: role === 'admin' ? 1 : 3,
                department: 'IT',
                position: 'To be assigned',
                salary: role === 'admin' ? 0 : payrollSettings.hourlyRate,
                joinDate: new Date().toISOString().split('T')[0],
                status: 'active'
            };
            
            employees.push(newUser);
            localStorage.setItem('employees', JSON.stringify(employees));
            
            alert('Registration successful! You can now login.');
            showLoginForm();
        }
        
        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            document.getElementById('admin-dashboard').classList.add('hidden');
            document.getElementById('employee-dashboard').classList.add('hidden');
            document.getElementById('login-page').classList.remove('hidden');
        }
        
        // Dashboard functions
        function showAdminDashboard() {
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('employee-dashboard').classList.add('hidden');
            document.getElementById('admin-dashboard').classList.remove('hidden');
            
            // Load admin dashboard data
            loadAdminDashboard();
            showAdminPage('dashboard');
        }
        
        function showEmployeeDashboard() {
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('admin-dashboard').classList.add('hidden');
            document.getElementById('employee-dashboard').classList.remove('hidden');
            
            // Load employee data
            loadEmployeeDashboard();
            showEmployeePage('dashboard');
            
            // Update employee name
            document.getElementById('employee-name').textContent = currentUser.name;
        }
        
        function showAdminPage(page) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
            
            // Show selected page
            document.getElementById(`admin-${page}-content`).classList.remove('hidden');
            
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === page) {
                    link.classList.add('active');
                }
            });
            
            // Load page-specific data
            switch(page) {
                case 'employees':
                    loadEmployeesTable();
                    break;
                case 'payroll':
                    loadPayrollSettings();
                    loadLoansTable();
                    break;
                case 'reports':
                    loadReportEmployees();
                    break;
                case 'efficiency':
                    loadEfficiencyData('all');
                    break;
                case 'financial':
                    // Already handled by generateFinancialSummary
                    break;
            }
        }
        
        function showEmployeePage(page) {
            // Hide all pages
            document.querySelectorAll('.page-content').forEach(p => p.classList.add('hidden'));
            
            // Show selected page
            document.getElementById(`employee-${page}-content`).classList.remove('hidden');
            
            // Update active nav link
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('data-page') === page) {
                    link.classList.add('active');
                }
            });
            
            // Load page-specific data
            switch(page) {
                case 'profile':
                    loadEmployeeProfile();
                    break;
                case 'timesheet':
                    loadEmployeeTimesheet();
                    break;
                case 'payroll':
                    // Already handled by viewEmployeePayroll
                    break;
            }
        }
        
        // Admin functions
        function loadAdminDashboard() {
            // Update stats
            document.getElementById('total-employees').textContent = employees.filter(e => e.role === 'employee').length;
            
            const today = new Date().toISOString().split('T')[0];
            const activeToday = attendance.filter(a => a.date === today).length;
            document.getElementById('active-today').textContent = activeToday;
            
            // Calculate currently working employees
            const workingEmployees = employees.filter(emp => {
                const clockStatus = localStorage.getItem(`clockStatus_${emp.id}`);
                return clockStatus && JSON.parse(clockStatus) === true;
            });
            document.getElementById('currently-working').textContent = workingEmployees.length;
            
            // Calculate monthly payroll
            const monthlyPayroll = employees.reduce((total, emp) => {
                if (emp.role === 'employee') {
                    if (emp.level === 3) {
                        // Hourly employees
                        const hours = attendance
                            .filter(a => a.employeeId === emp.id && 
                                a.date.startsWith(new Date().toISOString().substring(0, 7)))
                            .reduce((sum, a) => sum + a.hours + a.overtime, 0);
                        return total + (hours * emp.salary);
                    } else {
                        // Salaried employees
                        return total + emp.salary;
                    }
                }
                return total;
            }, 0);
            
            document.getElementById('month-payroll').textContent = `$${monthlyPayroll.toFixed(2)}`;
            
            // Load currently working employees
            const workingTable = document.getElementById('working-employees');
            workingTable.innerHTML = '';
            
            workingEmployees.forEach(emp => {
                const clockInTime = localStorage.getItem(`clockInTime_${emp.id}`);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${emp.name}</td>
                    <td>${emp.department}</td>
                    <td>${emp.position}</td>
                    <td>${clockInTime ? new Date(clockInTime).toLocaleTimeString() : 'N/A'}</td>
                    <td><span class="status-indicator status-active"></span> Working</td>
                `;
                workingTable.appendChild(row);
            });
            
            // Load recent activity
            const activityTable = document.getElementById('recent-activity');
            activityTable.innerHTML = '';
            
            // Get recent clock-ins (last 5)
            const recentAttendance = attendance
                .sort((a, b) => new Date(b.date + ' ' + b.clockIn) - new Date(a.date + ' ' + a.clockIn))
                .slice(0, 5);
            
            recentAttendance.forEach(record => {
                const employee = employees.find(e => e.id === record.employeeId);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${employee.name}</td>
                    <td>Clocked ${record.clockOut ? 'Out' : 'In'}</td>
                    <td>${record.date} ${record.clockOut ? record.clockOut : record.clockIn}</td>
                `;
                activityTable.appendChild(row);
            });
        }
        
        function loadEmployeesTable() {
            const table = document.getElementById('employees-table');
            table.innerHTML = '';
            
            employees.filter(e => e.role === 'employee').forEach(emp => {
                const isClockedIn = localStorage.getItem(`clockStatus_${emp.id}`) === 'true';
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${emp.id}</td>
                    <td>${emp.name}</td>
                    <td>${emp.email}</td>
                    <td>Level ${emp.level}</td>
                    <td>${emp.department}</td>
                    <td>${emp.position}</td>
                    <td>
                        <span class="status-indicator ${isClockedIn ? 'status-active' : 'status-inactive'}"></span>
                        ${isClockedIn ? 'Working' : 'Not Working'}
                    </td>
                    <td>
                        <button class="btn btn-primary" onclick="editEmployee(${emp.id})">Edit</button>
                        <button class="btn btn-danger" onclick="deleteEmployee(${emp.id})">Delete</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }
        
        function showAddEmployeeModal() {
            document.getElementById('add-employee-modal').classList.remove('hidden');
        }
        
        function hideAddEmployeeModal() {
            document.getElementById('add-employee-modal').classList.add('hidden');
            // Reset form
            document.getElementById('new-emp-name').value = '';
            document.getElementById('new-emp-email').value = '';
            document.getElementById('new-emp-password').value = '';
            document.getElementById('new-emp-level').value = '3';
            document.getElementById('new-emp-department').value = 'IT';
            document.getElementById('new-emp-position').value = '';
            document.getElementById('new-emp-salary').value = '';
            document.getElementById('new-emp-join-date').value = new Date().toISOString().split('T')[0];
        }
        
        function saveEmployee() {
            const name = document.getElementById('new-emp-name').value;
            const email = document.getElementById('new-emp-email').value;
            const password = document.getElementById('new-emp-password').value;
            const level = parseInt(document.getElementById('new-emp-level').value);
            const department = document.getElementById('new-emp-department').value;
            const position = document.getElementById('new-emp-position').value;
            const salary = parseFloat(document.getElementById('new-emp-salary').value);
            const joinDate = document.getElementById('new-emp-join-date').value;
            
            // Validate inputs
            if (!name || !email || !password || !department || !position || !salary) {
                alert('Please fill in all fields.');
                return;
            }
            
            // Check if email already exists
            const existingEmployee = employees.find(emp => emp.email === email);
            if (existingEmployee) {
                alert('An employee with this email already exists.');
                return;
            }
            
            // Create new employee
            const newEmployee = {
                id: employees.length > 0 ? Math.max(...employees.map(emp => emp.id)) + 1 : 1,
                name,
                email,
                password,
                role: 'employee',
                level,
                department,
                position,
                salary,
                joinDate,
                status: 'active'
            };
            
            employees.push(newEmployee);
            localStorage.setItem('employees', JSON.stringify(employees));
            
            hideAddEmployeeModal();
            loadEmployeesTable();
            loadAdminDashboard();
            
            alert('Employee added successfully!');
        }
        
        function editEmployee(id) {
            // For simplicity, we'll just allow editing through the profile in this demo
            alert('Edit functionality would open a form to modify employee details.');
        }
        
        function deleteEmployee(id) {
            if (confirm('Are you sure you want to delete this employee?')) {
                employees = employees.filter(emp => emp.id !== id);
                localStorage.setItem('employees', JSON.stringify(employees));
                loadEmployeesTable();
                loadAdminDashboard();
                alert('Employee deleted successfully!');
            }
        }
        
        function loadPayrollSettings() {
            document.getElementById('hourly-rate').value = payrollSettings.hourlyRate;
            document.getElementById('ot-rate').value = payrollSettings.otRate;
            document.getElementById('allowance-rate').value = payrollSettings.allowanceRate;
            document.getElementById('epf-rate').value = payrollSettings.epfRate;
            document.getElementById('etf-rate').value = payrollSettings.etfRate;
            document.getElementById('tax-rate').value = payrollSettings.taxRate;
        }
        
        function savePayrollSettings() {
            payrollSettings.hourlyRate = parseFloat(document.getElementById('hourly-rate').value);
            payrollSettings.otRate = parseFloat(document.getElementById('ot-rate').value);
            payrollSettings.allowanceRate = parseFloat(document.getElementById('allowance-rate').value);
            payrollSettings.epfRate = parseFloat(document.getElementById('epf-rate').value);
            payrollSettings.etfRate = parseFloat(document.getElementById('etf-rate').value);
            payrollSettings.taxRate = parseFloat(document.getElementById('tax-rate').value);
            
            localStorage.setItem('payrollSettings', JSON.stringify(payrollSettings));
            alert('Payroll settings saved successfully!');
        }
        
        function loadLoansTable() {
            const table = document.getElementById('loans-table');
            table.innerHTML = '';
            
            loans.forEach(loan => {
                const employee = employees.find(e => e.id === loan.employeeId);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${employee.name}</td>
                    <td>$${loan.amount.toFixed(2)}</td>
                    <td>${loan.installments}</td>
                    <td>$${loan.monthlyPayment.toFixed(2)}</td>
                    <td>$${loan.remaining.toFixed(2)}</td>
                    <td>${loan.startDate}</td>
                    <td>
                        <button class="btn btn-danger" onclick="deleteLoan(${loan.id})">Delete</button>
                    </td>
                `;
                table.appendChild(row);
            });
        }
        
        function showAddLoanModal() {
            // Populate employee dropdown
            const employeeSelect = document.getElementById('loan-employee');
            employeeSelect.innerHTML = '';
            
            employees.filter(e => e.role === 'employee').forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = emp.name;
                employeeSelect.appendChild(option);
            });
            
            document.getElementById('add-loan-modal').classList.remove('hidden');
        }
        
        function hideAddLoanModal() {
            document.getElementById('add-loan-modal').classList.add('hidden');
            // Reset form
            document.getElementById('loan-amount').value = '';
            document.getElementById('loan-installments').value = '12';
            document.getElementById('loan-date').value = new Date().toISOString().split('T')[0];
        }
        
        function saveLoan() {
            const employeeId = parseInt(document.getElementById('loan-employee').value);
            const amount = parseFloat(document.getElementById('loan-amount').value);
            const installments = parseInt(document.getElementById('loan-installments').value);
            const startDate = document.getElementById('loan-date').value;
            
            if (!employeeId || !amount || !installments || !startDate) {
                alert('Please fill in all fields.');
                return;
            }
            
            const monthlyPayment = amount / installments;
            
            const newLoan = {
                id: loans.length > 0 ? Math.max(...loans.map(l => l.id)) + 1 : 1,
                employeeId,
                amount,
                installments,
                monthlyPayment,
                remaining: amount,
                startDate
            };
            
            loans.push(newLoan);
            localStorage.setItem('loans', JSON.stringify(loans));
            
            hideAddLoanModal();
            loadLoansTable();
            
            alert('Loan added successfully!');
        }
        
        function deleteLoan(id) {
            if (confirm('Are you sure you want to delete this loan?')) {
                loans = loans.filter(loan => loan.id !== id);
                localStorage.setItem('loans', JSON.stringify(loans));
                loadLoansTable();
                alert('Loan deleted successfully!');
            }
        }
        
        function loadReportEmployees() {
            const select = document.getElementById('report-employee');
            // Keep the "All Employees" option
            while (select.children.length > 1) {
                select.removeChild(select.lastChild);
            }
            
            employees.filter(e => e.role === 'employee').forEach(emp => {
                const option = document.createElement('option');
                option.value = emp.id;
                option.textContent = emp.name;
                select.appendChild(option);
            });
        }
        
        function generateReport() {
            const month = document.getElementById('report-month').value;
            const employeeId = document.getElementById('report-employee').value;
            
            if (!month) {
                alert('Please select a month.');
                return;
            }
            
            // Filter employees for report
            let reportEmployees = employees.filter(e => e.role === 'employee');
            if (employeeId !== 'all') {
                reportEmployees = reportEmployees.filter(e => e.id === parseInt(employeeId));
            }
            
            // Generate report data
            const reportData = reportEmployees.map(emp => {
                // Get attendance for the selected month
                const monthAttendance = attendance.filter(a => 
                    a.employeeId === emp.id && a.date.startsWith(month)
                );
                
                let basicSalary, overtimePay, allowances, grossPay;
                
                if (emp.level === 3) {
                    // Hourly employee
                    const totalHours = monthAttendance.reduce((sum, a) => sum + a.hours, 0);
                    const totalOvertime = monthAttendance.reduce((sum, a) => sum + a.overtime, 0);
                    
                    basicSalary = totalHours * emp.salary;
                    overtimePay = totalOvertime * emp.salary * payrollSettings.otRate;
                    allowances = payrollSettings.allowanceRate;
                } else {
                    // Salaried employee
                    basicSalary = emp.salary;
                    overtimePay = 0;
                    allowances = payrollSettings.allowanceRate;
                }
                
                grossPay = basicSalary + overtimePay + allowances;
                
                // Calculate deductions
                const epfDeduction = grossPay * (payrollSettings.epfRate / 100);
                const etfDeduction = grossPay * (payrollSettings.etfRate / 100);
                const taxDeduction = grossPay * (payrollSettings.taxRate / 100);
                
                // Get loan deduction
                const employeeLoan = loans.find(l => l.employeeId === emp.id && l.remaining > 0);
                const loanDeduction = employeeLoan ? employeeLoan.monthlyPayment : 0;
                
                const totalDeductions = epfDeduction + etfDeduction + taxDeduction + loanDeduction;
                const netPay = grossPay - totalDeductions;
                
                return {
                    employee: emp.name,
                    department: emp.department,
                    basicSalary,
                    overtimePay,
                    allowances,
                    deductions: totalDeductions,
                    netPay
                };
            });
            
            // Display report
            const reportTable = document.getElementById('report-table');
            reportTable.innerHTML = '';
            
            reportData.forEach(data => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${data.employee}</td>
                    <td>${data.department}</td>
                    <td>$${data.basicSalary.toFixed(2)}</td>
                    <td>$${data.overtimePay.toFixed(2)}</td>
                    <td>$${data.allowances.toFixed(2)}</td>
                    <td>$${data.deductions.toFixed(2)}</td>
                    <td>$${data.netPay.toFixed(2)}</td>
                `;
                reportTable.appendChild(row);
            });
            
            document.getElementById('report-period').textContent = month;
            document.getElementById('report-results').classList.remove('hidden');
        }
        
        function exportReportPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add company header
            doc.setFontSize(20);
            doc.setTextColor(44, 62, 80); // Primary color
            doc.text('TECHNOVA SOLUTIONS', 105, 20, { align: 'center' });
            
            doc.setFontSize(16);
            doc.text('PAYROLL REPORT', 105, 30, { align: 'center' });
            
            // Add period
            const month = document.getElementById('report-month').value;
            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const monthName = monthNames[parseInt(month.split('-')[1]) - 1];
            const year = month.split('-')[0];
            
            doc.setFontSize(12);
            doc.setTextColor(100, 100, 100);
            doc.text(`For the month of ${monthName} ${year}`, 105, 40, { align: 'center' });
            
            // Add table headers
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            let yPosition = 60;
            
            // Table headers
            doc.setFillColor(240, 240, 240);
            doc.rect(10, yPosition, 190, 10, 'F');
            doc.text('Employee', 12, yPosition + 7);
            doc.text('Department', 50, yPosition + 7);
            doc.text('Basic Salary', 85, yPosition + 7);
            doc.text('Overtime', 115, yPosition + 7);
            doc.text('Allowances', 140, yPosition + 7);
            doc.text('Deductions', 165, yPosition + 7);
            doc.text('Net Pay', 185, yPosition + 7);
            
            yPosition += 10;
            
            // Add table data
            const reportTable = document.getElementById('report-table');
            const rows = reportTable.getElementsByTagName('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                if (cells.length > 0) {
                    doc.text(cells[0].textContent, 12, yPosition);
                    doc.text(cells[1].textContent, 50, yPosition);
                    doc.text(cells[2].textContent, 85, yPosition);
                    doc.text(cells[3].textContent, 115, yPosition);
                    doc.text(cells[4].textContent, 140, yPosition);
                    doc.text(cells[5].textContent, 165, yPosition);
                    doc.text(cells[6].textContent, 185, yPosition);
                    yPosition += 7;
                    
                    // Add new page if needed
                    if (yPosition > 270) {
                        doc.addPage();
                        yPosition = 20;
                    }
                }
            }
            
            // Add totals
            yPosition += 10;
            doc.setDrawColor(200, 200, 200);
            doc.line(10, yPosition, 200, yPosition);
            yPosition += 10;
            
            // Calculate totals
            let totalBasic = 0, totalOvertime = 0, totalAllowances = 0, totalDeductions = 0, totalNet = 0;
            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                if (cells.length > 0) {
                    totalBasic += parseFloat(cells[2].textContent.replace('$', ''));
                    totalOvertime += parseFloat(cells[3].textContent.replace('$', ''));
                    totalAllowances += parseFloat(cells[4].textContent.replace('$', ''));
                    totalDeductions += parseFloat(cells[5].textContent.replace('$', ''));
                    totalNet += parseFloat(cells[6].textContent.replace('$', ''));
                }
            }
            
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('TOTALS:', 12, yPosition);
            doc.text(`$${totalBasic.toFixed(2)}`, 85, yPosition);
            doc.text(`$${totalOvertime.toFixed(2)}`, 115, yPosition);
            doc.text(`$${totalAllowances.toFixed(2)}`, 140, yPosition);
            doc.text(`$${totalDeductions.toFixed(2)}`, 165, yPosition);
            doc.text(`$${totalNet.toFixed(2)}`, 185, yPosition);
            
            // Add footer
            yPosition += 20;
            doc.setFontSize(8);
            doc.setTextColor(150, 150, 150);
            doc.text('Generated by Payroll Management System', 105, yPosition, { align: 'center' });
            doc.text(new Date().toLocaleDateString(), 105, yPosition + 5, { align: 'center' });
            
            // Save the PDF
            doc.save(`payroll-report-${month}.pdf`);
        }
        
        function generateFinancialSummary() {
            const month = document.getElementById('financial-month').value;
            
            if (!month) {
                alert('Please select a month.');
                return;
            }
            
            // Calculate financial data
            let totalSalary = 0;
            let totalEPF = 0;
            let totalETF = 0;
            let totalTax = 0;
            let totalLoans = 0;
            
            const departmentData = {};
            const activeLoans = loans.filter(loan => loan.remaining > 0);
            
            employees.filter(e => e.role === 'employee').forEach(emp => {
                // Get attendance for the selected month
                const monthAttendance = attendance.filter(a => 
                    a.employeeId === emp.id && a.date.startsWith(month)
                );
                
                let basicSalary, overtimePay, allowances, grossPay;
                
                if (emp.level === 3) {
                    // Hourly employee
                    const totalHours = monthAttendance.reduce((sum, a) => sum + a.hours, 0);
                    const totalOvertime = monthAttendance.reduce((sum, a) => sum + a.overtime, 0);
                    
                    basicSalary = totalHours * emp.salary;
                    overtimePay = totalOvertime * emp.salary * payrollSettings.otRate;
                    allowances = payrollSettings.allowanceRate;
                } else {
                    // Salaried employee
                    basicSalary = emp.salary;
                    overtimePay = 0;
                    allowances = payrollSettings.allowanceRate;
                }
                
                grossPay = basicSalary + overtimePay + allowances;
                
                // Calculate deductions
                const epfDeduction = grossPay * (payrollSettings.epfRate / 100);
                const etfDeduction = grossPay * (payrollSettings.etfRate / 100);
                const taxDeduction = grossPay * (payrollSettings.taxRate / 100);
                
                // Get loan deduction
                const employeeLoan = loans.find(l => l.employeeId === emp.id && l.remaining > 0);
                const loanDeduction = employeeLoan ? employeeLoan.monthlyPayment : 0;
                
                // Update totals
                totalSalary += grossPay;
                totalEPF += epfDeduction;
                totalETF += etfDeduction;
                totalTax += taxDeduction;
                totalLoans += loanDeduction;
                
                // Update department data
                if (!departmentData[emp.department]) {
                    departmentData[emp.department] = {
                        employees: 0,
                        totalSalary: 0,
                        totalEPF: 0,
                        totalETF: 0
                    };
                }
                
                departmentData[emp.department].employees++;
                departmentData[emp.department].totalSalary += grossPay;
                departmentData[emp.department].totalEPF += epfDeduction;
                departmentData[emp.department].totalETF += etfDeduction;
            });
            
            // Update UI
            document.getElementById('total-salary').textContent = `$${totalSalary.toFixed(2)}`;
            document.getElementById('total-epf').textContent = `$${totalEPF.toFixed(2)}`;
            document.getElementById('total-etf').textContent = `$${totalETF.toFixed(2)}`;
            document.getElementById('total-tax').textContent = `$${totalTax.toFixed(2)}`;
            document.getElementById('total-loans').textContent = `$${totalLoans.toFixed(2)}`;
            document.getElementById('net-payroll').textContent = `$${(totalSalary - totalEPF - totalETF - totalTax - totalLoans).toFixed(2)}`;
            
            // Update department breakdown
            const departmentTable = document.getElementById('department-breakdown');
            departmentTable.innerHTML = '';
            
            for (const [dept, data] of Object.entries(departmentData)) {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${dept}</td>
                    <td>${data.employees}</td>
                    <td>$${data.totalSalary.toFixed(2)}</td>
                    <td>$${data.totalEPF.toFixed(2)}</td>
                    <td>$${data.totalETF.toFixed(2)}</td>
                `;
                departmentTable.appendChild(row);
            }
            
            // Update active loans
            const activeLoansTable = document.getElementById('active-loans');
            activeLoansTable.innerHTML = '';
            
            activeLoans.forEach(loan => {
                const employee = employees.find(e => e.id === loan.employeeId);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${employee.name}</td>
                    <td>$${loan.amount.toFixed(2)}</td>
                    <td>$${loan.monthlyPayment.toFixed(2)}</td>
                    <td>$${loan.remaining.toFixed(2)}</td>
                    <td>${loan.startDate}</td>
                `;
                activeLoansTable.appendChild(row);
            });
            
            document.getElementById('financial-period').textContent = month;
            document.getElementById('financial-results').classList.remove('hidden');
        }
        
        function loadEfficiencyData(level) {
            // Calculate efficiency scores based on hours worked
            const efficiencyData = employees
                .filter(e => e.role === 'employee' && (level === 'all' || e.level == level))
                .map(emp => {
                    // Get total hours worked in the current month
                    const currentMonth = new Date().toISOString().substring(0, 7);
                    const monthAttendance = attendance.filter(a => 
                        a.employeeId === emp.id && a.date.startsWith(currentMonth)
                    );
                    
                    const totalHours = monthAttendance.reduce((sum, a) => sum + a.hours + a.overtime, 0);
                    
                    // Simple efficiency calculation (hours worked)
                    // In a real system, this would be more sophisticated
                    const efficiency = totalHours;
                    
                    return {
                        employee: emp,
                        hours: totalHours,
                        efficiency
                    };
                })
                .sort((a, b) => b.efficiency - a.efficiency);
            
            // Update efficiency table
            const table = document.getElementById('efficiency-table');
            table.innerHTML = '';
            
            efficiencyData.forEach((data, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${data.employee.name}</td>
                    <td>Level ${data.employee.level}</td>
                    <td>${data.employee.department}</td>
                    <td>${data.hours.toFixed(1)}</td>
                    <td>${data.efficiency.toFixed(1)}</td>
                `;
                table.appendChild(row);
            });
            
            // Update pie chart
            updateEfficiencyPieChart(efficiencyData);
        }
        
        function updateEfficiencyPieChart(efficiencyData) {
            const ctx = document.getElementById('efficiency-pie-chart').getContext('2d');
            
            // Destroy existing chart if it exists
            if (efficiencyPieChart) {
                efficiencyPieChart.destroy();
            }
            
            // Prepare data for the pie chart
            const labels = efficiencyData.map(data => data.employee.name);
            const data = efficiencyData.map(data => data.efficiency);
            const backgroundColors = [
                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', 
                '#FF9F40', '#FF6384', '#C9CBCF', '#4BC0C0', '#FF6384'
            ];
            
            // Create new chart
            efficiencyPieChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: backgroundColors,
                        borderColor: '#fff',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        },
                        title: {
                            display: true,
                            text: 'Employee Efficiency Distribution'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ${value} hours (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Employee functions
        function loadEmployeeDashboard() {
            // Update stats
            const currentMonth = new Date().toISOString().substring(0, 7);
            const currentWeek = getWeekDates();
            
            const monthAttendance = attendance.filter(a => 
                a.employeeId === currentUser.id && a.date.startsWith(currentMonth)
            );
            
            const weekAttendance = attendance.filter(a => 
                a.employeeId === currentUser.id && currentWeek.includes(a.date)
            );
            
            const monthHours = monthAttendance.reduce((sum, a) => sum + a.hours + a.overtime, 0);
            const weekHours = weekAttendance.reduce((sum, a) => sum + a.hours + a.overtime, 0);
            const overtimeHours = monthAttendance.reduce((sum, a) => sum + a.overtime, 0);
            
            document.getElementById('hours-week').textContent = weekHours.toFixed(1);
            document.getElementById('hours-month').textContent = monthHours.toFixed(1);
            document.getElementById('overtime-hours').textContent = overtimeHours.toFixed(1);
            
            // Set next payday (15th of next month)
            const today = new Date();
            const nextPayday = new Date(today.getFullYear(), today.getMonth() + 1, 15);
            document.getElementById('next-payday').textContent = nextPayday.getDate() + ' ' + 
                nextPayday.toLocaleDateString('en-US', { month: 'short' });
            
            // Load recent activity
            const activityTable = document.getElementById('employee-activity');
            activityTable.innerHTML = '';
            
            // Get recent attendance (last 5)
            const recentAttendance = attendance
                .filter(a => a.employeeId === currentUser.id)
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 5);
            
            recentAttendance.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.date}</td>
                    <td>${record.clockIn}</td>
                    <td>${record.clockOut || '--:--'}</td>
                    <td>${(record.hours + record.overtime).toFixed(1)}</td>
                `;
                activityTable.appendChild(row);
            });
            
            // Update clock status
            updateClockStatus();
        }
        
        function getWeekDates() {
            const today = new Date();
            const currentDay = today.getDay();
            const startDate = new Date(today);
            startDate.setDate(today.getDate() - currentDay);
            
            const weekDates = [];
            for (let i = 0; i < 7; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                weekDates.push(date.toISOString().split('T')[0]);
            }
            
            return weekDates;
        }
        
        function updateClockStatus() {
            const clockInBtn = document.getElementById('clock-in-btn');
            const clockOutBtn = document.getElementById('clock-out-btn');
            const clockStatus = document.getElementById('clock-status');
            
            if (clockedIn) {
                clockInBtn.disabled = true;
                clockOutBtn.disabled = false;
                clockStatus.textContent = `You are currently clocked in since ${clockInTime.toLocaleTimeString()}`;
            } else {
                clockInBtn.disabled = false;
                clockOutBtn.disabled = true;
                clockStatus.textContent = 'You are currently clocked out';
            }
        }
        
        function clockIn() {
            clockedIn = true;
            clockInTime = new Date();
            
            localStorage.setItem(`clockStatus_${currentUser.id}`, JSON.stringify(clockedIn));
            localStorage.setItem(`clockInTime_${currentUser.id}`, clockInTime.toISOString());
            
            // Add to attendance (without clock out time yet)
            const today = new Date().toISOString().split('T')[0];
            const timeString = clockInTime.toTimeString().split(' ')[0].substring(0, 5);
            
            // Check if there's already an entry for today
            const existingEntry = attendance.find(a => 
                a.employeeId === currentUser.id && a.date === today
            );
            
            if (!existingEntry) {
                const newAttendance = {
                    id: attendance.length > 0 ? Math.max(...attendance.map(a => a.id)) + 1 : 1,
                    employeeId: currentUser.id,
                    date: today,
                    clockIn: timeString,
                    clockOut: null,
                    hours: 0,
                    overtime: 0
                };
                
                attendance.push(newAttendance);
                localStorage.setItem('attendance', JSON.stringify(attendance));
            }
            
            updateClockStatus();
            alert(`Clocked in at ${timeString}`);
        }
        
        function clockOut() {
            if (!clockedIn) {
                alert('You are not clocked in.');
                return;
            }
            
            clockedIn = false;
            const clockOutTime = new Date();
            
            localStorage.setItem(`clockStatus_${currentUser.id}`, JSON.stringify(clockedIn));
            
            // Update attendance record
            const today = new Date().toISOString().split('T')[0];
            const timeString = clockOutTime.toTimeString().split(' ')[0].substring(0, 5);
            
            const attendanceRecord = attendance.find(a => 
                a.employeeId === currentUser.id && a.date === today
            );
            
            if (attendanceRecord) {
                attendanceRecord.clockOut = timeString;
                
                // Calculate hours worked
                const clockIn = new Date(`${today}T${attendanceRecord.clockIn}`);
                const clockOut = new Date(`${today}T${timeString}`);
                
                let hoursWorked = (clockOut - clockIn) / (1000 * 60 * 60);
                
                // Calculate regular hours and overtime
                let regularHours = Math.min(hoursWorked, 8);
                let overtime = Math.max(hoursWorked - 8, 0);
                
                attendanceRecord.hours = regularHours;
                attendanceRecord.overtime = overtime;
                
                localStorage.setItem('attendance', JSON.stringify(attendance));
            }
            
            updateClockStatus();
            loadEmployeeDashboard();
            
            alert(`Clocked out at ${timeString}`);
        }
        
        function loadEmployeeProfile() {
            document.getElementById('emp-name').value = currentUser.name;
            document.getElementById('emp-email').value = currentUser.email;
            document.getElementById('emp-id').value = currentUser.id;
            document.getElementById('emp-level').value = `Level ${currentUser.level}`;
            document.getElementById('emp-department').value = currentUser.department;
            document.getElementById('emp-position').value = currentUser.position;
            document.getElementById('emp-join-date').value = currentUser.joinDate;
            
            if (currentUser.level === 3) {
                document.getElementById('emp-salary').value = `$${currentUser.salary}/hour`;
            } else {
                document.getElementById('emp-salary').value = `$${currentUser.salary}/month`;
            }
        }
        
        function enableProfileEdit() {
            const inputs = document.querySelectorAll('#employee-profile-content input');
            inputs.forEach(input => {
                if (input.id !== 'emp-id' && input.id !== 'emp-level' && input.id !== 'emp-join-date') {
                    input.readOnly = false;
                }
            });
            
            document.getElementById('profile-edit-buttons').classList.remove('hidden');
            document.getElementById('edit-profile-btn').classList.add('hidden');
        }
        
        function saveProfile() {
            const name = document.getElementById('emp-name').value;
            const email = document.getElementById('emp-email').value;
            const department = document.getElementById('emp-department').value;
            const position = document.getElementById('emp-position').value;
            
            // Update current user
            currentUser.name = name;
            currentUser.email = email;
            currentUser.department = department;
            currentUser.position = position;
            
            // Update in employees array
            const employeeIndex = employees.findIndex(e => e.id === currentUser.id);
            if (employeeIndex !== -1) {
                employees[employeeIndex] = currentUser;
                localStorage.setItem('employees', JSON.stringify(employees));
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
            }
            
            cancelProfileEdit();
            loadEmployeeProfile();
            
            alert('Profile updated successfully!');
        }
        
        function cancelProfileEdit() {
            const inputs = document.querySelectorAll('#employee-profile-content input');
            inputs.forEach(input => {
                input.readOnly = true;
            });
            
            document.getElementById('profile-edit-buttons').classList.add('hidden');
            document.getElementById('edit-profile-btn').classList.remove('hidden');
            
            // Reload original data
            loadEmployeeProfile();
        }
        
        function loadEmployeeTimesheet() {
            const month = document.getElementById('timesheet-month').value || 
                new Date().toISOString().substring(0, 7);
            
            const table = document.getElementById('timesheet-table');
            table.innerHTML = '';
            
            const monthAttendance = attendance.filter(a => 
                a.employeeId === currentUser.id && a.date.startsWith(month)
            );
            
            monthAttendance.forEach(record => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${record.date}</td>
                    <td>${record.clockIn}</td>
                    <td>${record.clockOut || '--:--'}</td>
                    <td>${record.hours.toFixed(1)}</td>
                    <td>${record.overtime.toFixed(1)}</td>
                    <td>${(record.hours + record.overtime).toFixed(1)}</td>
                `;
                table.appendChild(row);
            });
            
            // If no records, show a message
            if (monthAttendance.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="6" style="text-align: center;">No records found for ${month}</td>`;
                table.appendChild(row);
            }
        }
        
        function viewEmployeePayroll() {
            const month = document.getElementById('payroll-month').value;
            
            if (!month) {
                alert('Please select a month.');
                return;
            }
            
            // Get attendance for the selected month
            const monthAttendance = attendance.filter(a => 
                a.employeeId === currentUser.id && a.date.startsWith(month)
            );
            
            let basicSalary, overtimePay, allowances, grossPay;
            
            if (currentUser.level === 3) {
                // Hourly employee
                const totalHours = monthAttendance.reduce((sum, a) => sum + a.hours, 0);
                const totalOvertime = monthAttendance.reduce((sum, a) => sum + a.overtime, 0);
                
                basicSalary = totalHours * currentUser.salary;
                overtimePay = totalOvertime * currentUser.salary * payrollSettings.otRate;
                allowances = payrollSettings.allowanceRate;
            } else {
                // Salaried employee
                basicSalary = currentUser.salary;
                overtimePay = 0;
                allowances = payrollSettings.allowanceRate;
            }
            
            grossPay = basicSalary + overtimePay + allowances;
            
            // Calculate deductions
            const epfDeduction = grossPay * (payrollSettings.epfRate / 100);
            const etfDeduction = grossPay * (payrollSettings.etfRate / 100);
            const taxDeduction = grossPay * (payrollSettings.taxRate / 100);
            
            // Get loan deduction
            const employeeLoan = loans.find(l => l.employeeId === currentUser.id && l.remaining > 0);
            const loanDeduction = employeeLoan ? employeeLoan.monthlyPayment : 0;
            
            const totalDeductions = epfDeduction + etfDeduction + taxDeduction + loanDeduction;
            const netPay = grossPay - totalDeductions;
            
            // Update UI
            document.getElementById('payroll-basic').value = `$${basicSalary.toFixed(2)}`;
            document.getElementById('payroll-overtime').value = `$${overtimePay.toFixed(2)}`;
            document.getElementById('payroll-allowances').value = `$${allowances.toFixed(2)}`;
            document.getElementById('payroll-gross').value = `$${grossPay.toFixed(2)}`;
            document.getElementById('payroll-epf').value = `$${epfDeduction.toFixed(2)}`;
            document.getElementById('payroll-etf').value = `$${etfDeduction.toFixed(2)}`;
            document.getElementById('payroll-tax').value = `$${taxDeduction.toFixed(2)}`;
            document.getElementById('payroll-loan').value = `$${loanDeduction.toFixed(2)}`;
            document.getElementById('payroll-deductions').value = `$${totalDeductions.toFixed(2)}`;
            document.getElementById('payroll-net').value = `$${netPay.toFixed(2)}`;
            
            document.getElementById('payroll-period').textContent = month;
            document.getElementById('payroll-details').classList.remove('hidden');
        }
        
        function exportEmployeePayrollPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Add company header
            doc.setFontSize(20);
            doc.setTextColor(44, 62, 80); // Primary color
            doc.text('TECHNOVA SOLUTIONS', 105, 20, { align: 'center' });
            
            doc.setFontSize(16);
            doc.text('PAYROLL SLIP', 105, 30, { align: 'center' });
            
            // Add period
            const month = document.getElementById('payroll-month').value;
            const monthNames = ["January", "February", "March", "April", "May", "June",
                "July", "August", "September", "October", "November", "December"
            ];
            const monthName = monthNames[parseInt(month.split('-')[1]) - 1];
            const year = month.split('-')[0];
            
            doc.setFontSize(12);
            doc.setTextColor(100, 100, 100);
            doc.text(`For the month of ${monthName} ${year}`, 105, 40, { align: 'center' });
            
            // Add employee details
            doc.setFontSize(10);
            doc.setTextColor(0, 0, 0);
            let yPosition = 60;
            
            doc.text(`Employee ID: ${currentUser.id}`, 20, yPosition);
            doc.text(`Employee Name: ${currentUser.name}`, 20, yPosition + 7);
            doc.text(`Department: ${currentUser.department}`, 20, yPosition + 14);
            doc.text(`Position: ${currentUser.position}`, 20, yPosition + 21);
            doc.text(`Level: ${currentUser.level}`, 20, yPosition + 28);
            
            yPosition += 40;
            
            // Add payroll details header
            doc.setFillColor(240, 240, 240);
            doc.rect(10, yPosition, 190, 10, 'F');
            doc.text('Earnings', 12, yPosition + 7);
            doc.text('Amount ($)', 150, yPosition + 7);
            
            yPosition += 10;
            
            // Add earnings
            const basicSalary = document.getElementById('payroll-basic').value;
            const overtimePay = document.getElementById('payroll-overtime').value;
            const allowances = document.getElementById('payroll-allowances').value;
            const grossPay = document.getElementById('payroll-gross').value;
            
            doc.text('Basic Salary', 12, yPosition);
            doc.text(basicSalary, 150, yPosition);
            yPosition += 7;
            
            doc.text('Overtime Pay', 12, yPosition);
            doc.text(overtimePay, 150, yPosition);
            yPosition += 7;
            
            doc.text('Allowances', 12, yPosition);
            doc.text(allowances, 150, yPosition);
            yPosition += 7;
            
            doc.setDrawColor(200, 200, 200);
            doc.line(10, yPosition, 200, yPosition);
            yPosition += 10;
            
            doc.setFont(undefined, 'bold');
            doc.text('Gross Pay', 12, yPosition);
            doc.text(grossPay, 150, yPosition);
            yPosition += 15;
            
            // Add deductions header
            doc.setFillColor(240, 240, 240);
            doc.rect(10, yPosition, 190, 10, 'F');
            doc.text('Deductions', 12, yPosition + 7);
            doc.text('Amount ($)', 150, yPosition + 7);
            
            yPosition += 10;
            
            // Add deductions
            const epfDeduction = document.getElementById('payroll-epf').value;
            const etfDeduction = document.getElementById('payroll-etf').value;
            const taxDeduction = document.getElementById('payroll-tax').value;
            const loanDeduction = document.getElementById('payroll-loan').value;
            const totalDeductions = document.getElementById('payroll-deductions').value;
            
            doc.setFont(undefined, 'normal');
            doc.text('EPF Deduction', 12, yPosition);
            doc.text(epfDeduction, 150, yPosition);
            yPosition += 7;
            
            doc.text('ETF Deduction', 12, yPosition);
            doc.text(etfDeduction, 150, yPosition);
            yPosition += 7;
            
            doc.text('Tax Deduction', 12, yPosition);
            doc.text(taxDeduction, 150, yPosition);
            yPosition += 7;
            
            doc.text('Loan Installment', 12, yPosition);
            doc.text(loanDeduction, 150, yPosition);
            yPosition += 7;
            
            doc.setDrawColor(200, 200, 200);
            doc.line(10, yPosition, 200, yPosition);
            yPosition += 10;
            
            doc.setFont(undefined, 'bold');
            doc.text('Total Deductions', 12, yPosition);
            doc.text(totalDeductions, 150, yPosition);
            yPosition += 15;
            
            // Add net pay
            const netPay = document.getElementById('payroll-net').value;
            
            doc.setFillColor(44, 62, 80);
            doc.rect(10, yPosition, 190, 15, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(12);
            doc.text('NET PAY', 12, yPosition + 10);
            doc.text(netPay, 150, yPosition + 10);
            
            // Add footer
            yPosition += 25;
            doc.setTextColor(150, 150, 150);
            doc.setFontSize(8);
            doc.text('Generated by Payroll Management System', 105, yPosition, { align: 'center' });
            doc.text(new Date().toLocaleDateString(), 105, yPosition + 5, { align: 'center' });
            
            // Save the PDF
            doc.save(`payroll-slip-${currentUser.name}-${month}.pdf`);
        }
    </script>
<script type="module" src="firebase.js"></script>

</body>
</html>